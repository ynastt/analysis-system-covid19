# Разработка системы анализа медицинских изображений для эпидемиологического мониторинга COVID-19
Итоговый проект по дисциплине «Инфраструктура Big Data»

### Цель проекта
Разработать аналитическую систему для эпидемиологического мониторинга COVID-19 на основе метаданных рентгеновских снимков, используя стек PySpark.

### Описание задачи
Необходимо подготовить данные, провести SQL-анализ и базовую обработку в Spark, а также визуализировать результаты и оформить выводы.

### Структура проекта
```
analysis-system-covid19/
├── analysis.ipynb
├── presentation.pdf
├── README.md
└── requirements.txt
```

### Инструкции по запуску проекта

- Установить версию pyhton $\ge$ 3.12.12:

- Установить зависимости, выполнив команду:
   - в Google Colab:
     выполнять ячейку
     ```
     !pip install -r requirements.txt
     ```
   - для локального запуска
     ```
     pip install -r requirements.txt
     ```
     ```
     jupyter notebook
     ```

### Этапы работы
 Файл analysis.ipynb содержит все этапы обработки и анализа данных:
- инициализация сессии
- загрузка датасета metadata.csv
- очистка данных. Заполнение пропусков:
  - 80 пропусков в `sex` заполнены пропорционально существующему распределению в данных,
  - 237 пропусков в `age` заполнены средним возрастом,
  - 289 пропусков в `date` заполнены максимальной датой (2020-04-06).
- очистка данных. Удаление дубликатов (с помощью dropDuplicates())
- онализ распредления пропущенных значений по столбцам, выявленгие аномалий и их обработка
- sql-аналитика с помощью запросов:
  - базовая статистика по диагнозам
  - распределение по полу и диагнозам.
  - оконная функция (топ-3 по возрасту в каждой группе диагнозов).
  - анализ временных трендов по датам исследований.
  - статистика по проекциям снимков и их связи с диагнозами.
- обработка в PySpark. Категоризация возраста. Унификация диагнозов. Реализация UDF
- визуализация(pie, bar, timeline, heatmap)

### Вывод
Проект показал, что среди пациентов с COVID-19 преобладают взрослые люди 20-60 лет, большая часть - лица старше 50 лет. Анализ временных трендов выявил рост количества исследований в годы обострения эпидемии - 2019 и 2020. Распределения по возрасту, полу, диагнозам и датам демонстрируют закономерности, которые соответствуют ожидаемыми медицинскими и временными трендам заболеваемости.
Основные трудности в процессе работы связаны с неполнотой метаданных, особенно в полях возраста, пола, даты - в них присутствовали пропущенные значения. Для улучшения системы можно рекомендовать более строгую валидацию данных на этапе сбора.
